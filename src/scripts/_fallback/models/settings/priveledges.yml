editable: &editable
  .show:
    # use `true` to set privilege
    # active by default
    selected: false
    # `scope` is a keyword!
    # it should be used for tranformations (see below)
    # depends object represents key, that should be
    # trigger item toggling & locking (see logic in role.coffee)
    depends: [scope]
  .edit: false

crud: &crud
  << : *editable
  .delete: false

policy: &policy-crud
  << : *crud
  .edit_rule: false
  .edit_action: false

+dashboards/dashboard:
  # @note should be tranformed to:
  #
  #   .show:
  #     selected: false
  #     depends:
  #       - monitoring_dashboards_edit
  #       - monitoring_dashboards_delete
  #   .edit: false
  #   .delete: false
  #
  << : *crud

+events:
  .event:show:
    selected: false
    depends: [scope, reports/report:show]
  .event:export: false
  .event:edit_user_decision: false
  .event:edit_tag: false
  .query:show:
    selected: false
    depends: [query:edit, query:delete, reports/report:show]
  .query:edit: false
  .query:delete: false

+reports/report:
  << : *crud
  .execute: false
  .download: false

+analysis:
  -term:
    << : *crud
  -text_object:
    << : *crud
  -fingerprint:
    << : *crud
  -form:
    << : *crud
  -stamp:
    << : *crud
  -table:
    << : *crud
  -graphic:
    .show: false
  .export: false

+organization:
  -group:
    << : *crud
    .show:
      selected: false
      depends:
        - person:show
  -person:
    << : *crud
    .set_status: false
  -workstation:
    << : *crud
    .set_status: false

+protected:
  .show:
    selected: false
    depends: [scope]
  .catalog:edit: false
  .catalog:delete: false
  .document:edit: false
  .document:delete: false
  .export: false

+policy:
  -policy_object:
    << : *policy-crud
  -policy_person:
    << : *policy-crud

+lists:
  -tag:
    << : *crud
  -resources/resource:
    << : *crud
  -statuses/status:
    << : *crud
  -perimeters/perimeter:
    << : *crud
  -file:
    .show: false

+settings:
  -ldap:
    << : *crud
    .start_sync: false

  -access:
    -user:
      << : *crud
      .set_role: false
      .set_scope: false
    -role:
      << : *crud
    -scope:
      << : *crud

  -license:
    << : *crud

  -audit_events/audit_event:
    .show: false
    .edit_duration: false

  -system_check:
    .show:
      selected: false
      depends: [scope]
    .crash_notice:show:
      selected: false
      depends: [scope]
    .crash_notice:edit: false

  -network:
    << : *editable

  -update:
    .show: false

  -services:
    .service:show:
      selected: false
      depends: [scope]
    .service:edit: false
    .diagnostic:execute: false

  -plugins:
    << : *crud

  -integrity_monitoring/integrity:
    .show:
      selected: false
      depends: [scope]
    .scan: false
    .form_etalon: false

+crawler:
  -task:
    << : *crud
    .execute: false
